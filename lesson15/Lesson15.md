# å¾®æœåŠ¡æ¡†æ¶ä»‹ç»åŠä½¿ç”¨

[go-zeroå®˜ç½‘](https://go-zero.dev/)

## æ¡†æ¶æ¦‚è¿°

## go-zero[](https://go-zero.dev/docs/concepts/overview#go-zero)

> ***ç¼©çŸ­ä»éœ€æ±‚åˆ°ä¸Šçº¿çš„è·ç¦»\***

go-zero æ˜¯ä¸€ä¸ªé›†æˆäº†å„ç§å·¥ç¨‹å®è·µçš„ web å’Œ rpc æ¡†æ¶ã€‚é€šè¿‡å¼¹æ€§è®¾è®¡ä¿éšœäº†å¤§å¹¶å‘æœåŠ¡ç«¯çš„ç¨³å®šæ€§ï¼Œç»å—äº†å……åˆ†çš„å®æˆ˜æ£€éªŒã€‚

go-zero åŒ…å«æç®€çš„ API å®šä¹‰å’Œç”Ÿæˆå·¥å…· goctlï¼Œå¯ä»¥æ ¹æ®å®šä¹‰çš„ api æ–‡ä»¶ä¸€é”®ç”Ÿæˆ Go, iOS, Android, Kotlin, Dart, TypeScript, JavaScript ä»£ç ï¼Œå¹¶å¯ç›´æ¥è¿è¡Œã€‚

## ä½¿ç”¨ go-zero çš„å¥½å¤„[](https://go-zero.dev/docs/concepts/overview#ä½¿ç”¨-go-zero-çš„å¥½å¤„)

- è½»æ¾è·å¾—æ”¯æ’‘åƒä¸‡æ—¥æ´»æœåŠ¡çš„ç¨³å®šæ€§
- å†…å»ºçº§è”è¶…æ—¶æ§åˆ¶ã€é™æµã€è‡ªé€‚åº”ç†”æ–­ã€è‡ªé€‚åº”é™è½½ç­‰å¾®æœåŠ¡æ²»ç†èƒ½åŠ›ï¼Œæ— éœ€é…ç½®å’Œé¢å¤–ä»£ç 
- å¾®æœåŠ¡æ²»ç†ä¸­é—´ä»¶å¯æ— ç¼é›†æˆåˆ°å…¶å®ƒç°æœ‰æ¡†æ¶ä½¿ç”¨
- æç®€çš„ API æè¿°ï¼Œä¸€é”®ç”Ÿæˆå„ç«¯ä»£ç 
- è‡ªåŠ¨æ ¡éªŒå®¢æˆ·ç«¯è¯·æ±‚å‚æ•°åˆæ³•æ€§
- å¤§é‡å¾®æœåŠ¡æ²»ç†å’Œå¹¶å‘å·¥å…·åŒ…

### ä¸‹è½½

åœ¨æ­£å¼å¼€å§‹ä½¿ç”¨go-zeroæ¡†æ¶ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆå®‰è£…å¯¹åº”çš„ç»„ä»¶ã€‚

[goctl å®‰è£… | go-zero Documentation](https://go-zero.dev/docs/tasks/installation/goctl)ï¼ˆgoctl æ˜¯ go-zero çš„å†…ç½®è„šæ‰‹æ¶ï¼Œæ˜¯æå‡å¼€å‘æ•ˆç‡çš„ä¸€å¤§åˆ©å™¨ï¼Œå¯ä»¥ä¸€é”®ç”Ÿæˆä»£ç ã€æ–‡æ¡£ã€éƒ¨ç½² k8s yamlã€dockerfile ç­‰ã€‚ï¼‰

[protoc å®‰è£… | go-zero Documentation](https://go-zero.dev/docs/tasks/installation/protoc)ï¼ˆ[protoc](https://protobuf.dev/) æ˜¯ä¸€ä¸ªç”¨äºç”Ÿæˆä»£ç çš„å·¥å…·ï¼Œå®ƒå¯ä»¥æ ¹æ® proto æ–‡ä»¶ç”ŸæˆC++ã€Javaã€Pythonã€Goã€PHP ç­‰å¤šé‡è¯­è¨€çš„ä»£ç ï¼Œè€Œ gRPC çš„ä»£ç ç”Ÿæˆè¿˜ä¾èµ– [protoc-gen-go](https://github.com/golang/protobuf/tree/master/protoc-gen-go)ï¼Œ[protoc-gen-go-grpc](https://pkg.go.dev/google.golang.org/grpc/cmd/protoc-gen-go-grpc) æ’ä»¶æ¥é…åˆç”Ÿæˆ Go è¯­è¨€çš„ gRPC ä»£ç ã€‚ï¼‰

[go-zero å®‰è£… | go-zero Documentation](https://go-zero.dev/docs/tasks/installation/go-zero)

[goctl-intellij å®‰è£… | go-zero Documentation](https://go-zero.dev/docs/tasks/installation/goctl-intellij)ï¼ˆgoctl-intellij æ˜¯ go-zero api æè¿°è¯­è¨€çš„ intellij ç¼–è¾‘å™¨æ’ä»¶ï¼Œæ”¯æŒ api æè¿°è¯­è¨€é«˜äº®ã€è¯­æ³•æ£€æµ‹ã€å¿«é€Ÿæç¤ºã€åˆ›å»ºæ¨¡æ¿ç‰¹æ€§ã€‚ï¼‰

### æ•™ç¨‹ï¼ˆè¿™é‡Œæ•™å¤§å®¶æœ€åŸºæœ¬çš„ä¸€äº›ä½¿ç”¨æ–¹æ³•ï¼Œè¿›é˜¶ç”¨æ³•è¿˜å¾—ä¸‹æ¥èŠ±æ—¶é—´å­¦ä¹ æˆç†Ÿçš„é¡¹ç›®æ‰è¡Œï¼‰

ä»¥ç”¨æˆ·æ³¨å†Œæ¥å£ä¸ºä¾‹ï¼š

è¿™é‡Œä»¥useræœåŠ¡ä¸ºä¾‹ï¼Œé¦–å…ˆæˆ‘ä»¬å…ˆå®šä¹‰useræœåŠ¡çš„apiæ–‡ä»¶ï¼š

```
syntax = "v1"

type (
    // å®šä¹‰æ³¨å†Œæ¥å£çš„è¯·æ±‚ä½“
    RegisterReq {
       Username string `json:"username"`
       Password string `json:"password"`
    }
    // å®šä¹‰ç™»å½•æ¥å£çš„å“åº”ä½“
    RegisterResp {
       Code int64  `json:"code"`
       Msg  string `json:"msg"`
    }
)

// å®šä¹‰ HTTP æœåŠ¡
// å¾®æœåŠ¡åç§°ä¸º userï¼Œç”Ÿæˆçš„ä»£ç ç›®å½•å’Œé…ç½®æ–‡ä»¶å°†å’Œ user å€¼ç›¸å…³
service user {
    // å®šä¹‰ http.HandleFunc è½¬æ¢çš„ go æ–‡ä»¶åç§°åŠæ–¹æ³•
    @handler Register
    // å®šä¹‰æ¥å£
    // è¯·æ±‚æ–¹æ³•ä¸º post
    // è·¯ç”±ä¸º /user/login
    // è¯·æ±‚ä½“ä¸º RegisterReq
    // å“åº”ä½“ä¸º RegisterRespï¼Œå“åº”ä½“å¿…é¡»æœ‰ returns å…³é”®å­—ä¿®é¥°
    post /user/register (RegisterReq) returns (RegisterResp)
}
```

å®šä¹‰å¥½useræœåŠ¡çš„apiæ–‡ä»¶åï¼Œæˆ‘ä»¬å†æ¥å®šä¹‰useræœåŠ¡rpcå¯¹åº”çš„protoæ–‡ä»¶ï¼š

```
syntax = "proto3";

package user;

option go_package = "./pb";

message RegisterReq{
    string Username =1;
    string Password =2;
}

message RegisterResp{
}

service User{
  rpc Register(RegisterReq) returns(RegisterResp);
}
```

å®šä¹‰å®Œæˆåï¼Œæˆ‘ä»¬ä½¿ç”¨goctlå·¥å…·ç”Ÿæˆapiå’Œrpcçš„ä»£ç ï¼š

åœ¨apiæ–‡ä»¶çš„çˆ¶ç›®å½•descä¸‹æ‰“å¼€ç»ˆç«¯æ‰§è¡Œï¼š

`goctl api go -api user.api -dir ../  --style=goZero`

(user.apiæ›¿æ¢æˆä½ çš„apiæ–‡ä»¶)(../è¡¨ç¤ºç”Ÿæˆçš„ä»£ç åœ¨descçš„çˆ¶ç›®å½•ä¸‹)

åœ¨protoæ–‡ä»¶çš„çˆ¶ç›®å½•descä¸‹æ‰“å¼€ç»ˆç«¯æ‰§è¡Œï¼š

`goctl rpc protoc user.proto --go_out=../ --go-grpc_out=../  --zrpc_out=../ --style=goZero`

(user.protoæ›¿æ¢æˆä½ çš„protoæ–‡ä»¶)(../è¡¨ç¤ºç”Ÿæˆçš„ä»£ç åœ¨descçš„çˆ¶ç›®å½•ä¸‹)

éšååˆ·æ–°ä¸€ä¸‹é¡¹ç›®ï¼Œä½ ä¼šå‘ç°å¤šäº†å¾ˆå¤šä¸œè¥¿ï¼š

example
â”œâ”€â”€ etc
â”‚   â””â”€â”€ example.yaml
â”œâ”€â”€ main.go
â””â”€â”€ internal
    â”œâ”€â”€ config
    â”‚   â””â”€â”€ config.go
    â”œâ”€â”€ handler
    â”‚   â”œâ”€â”€ xxxhandler.go
    â”‚   â””â”€â”€ xxxhandler.go
    â”œâ”€â”€ logic
    â”‚   â””â”€â”€ xxxlogic.go
    â”œâ”€â”€ svc
    â”‚   â””â”€â”€ servicecontext.go
    â””â”€â”€ types
        â””â”€â”€ types.go

- exampleï¼šå•ä¸ªæœåŠ¡ç›®å½•ï¼Œä¸€èˆ¬æ˜¯æŸå¾®æœåŠ¡åç§°
- etcï¼šé™æ€é…ç½®æ–‡ä»¶ç›®å½•
- main.goï¼šç¨‹åºå¯åŠ¨å…¥å£æ–‡ä»¶
- internalï¼šå•ä¸ªæœåŠ¡å†…éƒ¨æ–‡ä»¶ï¼Œå…¶å¯è§èŒƒå›´ä»…é™å½“å‰æœåŠ¡
- configï¼šé™æ€é…ç½®æ–‡ä»¶å¯¹åº”çš„ç»“æ„ä½“å£°æ˜ç›®å½•
- handlerï¼šhandler ç›®å½•ï¼Œå¯é€‰ï¼Œä¸€èˆ¬ http æœåŠ¡ä¼šæœ‰è¿™ä¸€å±‚åšè·¯ç”±ç®¡ç†ï¼Œ`handler` ä¸ºå›ºå®šåç¼€
- logicï¼šä¸šåŠ¡ç›®å½•ï¼Œæ‰€æœ‰ä¸šåŠ¡ç¼–ç æ–‡ä»¶éƒ½å­˜æ”¾åœ¨è¿™ä¸ªç›®å½•ä¸‹é¢ï¼Œ`logic` ä¸ºå›ºå®šåç¼€
- svcï¼šä¾èµ–æ³¨å…¥ç›®å½•ï¼Œæ‰€æœ‰ logic å±‚éœ€è¦ç”¨åˆ°çš„ä¾èµ–éƒ½è¦åœ¨è¿™é‡Œè¿›è¡Œæ˜¾å¼æ³¨å…¥
- typesï¼šç»“æ„ä½“å­˜æ”¾ç›®å½•

æˆ‘ä»¬ä»¥rpcçš„é…ç½®æ–‡ä»¶user.ymlä¸ºä¾‹ï¼š

```yaml
Name: user.rpc
ListenOn: 0.0.0.0:8081 #ç›‘å¬åœ¨8081ç«¯å£ä¸Šï¼Œé»˜è®¤ä¸º8080
Etcd: #go-zeroè‡ªåŠ¨å¸®æˆ‘ä»¬æŠŠæœåŠ¡æ³¨å†Œåˆ°etcdä¸Šï¼Œè¿™ä¹Ÿæ˜¯æ¡†æ¶çš„ä¸€å¤§å¥½å¤„ã€‚
  Hosts:
  - 127.0.0.1:2379
  Key: user.rpc #æœåŠ¡çš„key
```

åœ¨æ­£å¼å¼€å§‹å†™ä¸šåŠ¡é€»è¾‘ä¹‹å‰çš„ä¸€äº›å·¥ä½œï¼š

docker-compose.ymlç”¨æ¥å¯åŠ¨ä¸€äº›ç»„ä»¶ï¼ˆè¿™é‡Œè€ƒè™‘åˆ°å½“å‰å­¦ä¹ è¿›åº¦ï¼Œæˆ‘åªä½¿ç”¨mysqlã€redisã€etcdæ¥æ¼”ç¤ºï¼Œå®é™…åˆ°åé¢å­¦ä¹ åè¿˜æœ‰å¾ˆå¤šç»„ä»¶ä¾›ä½ ä½¿ç”¨ã€‚ã€‚ï¼‰

```yaml
version: '3.8'

networks:
  demo:
    driver: bridge

services:
  mysql:
    image: mysql:latest
    container_name: mysql-1
    ports:
      - "3306:3306"
    environment:
      - TZ=${TZ}
      - MYSQL_PASSWORD=123456              # è®¾ç½® Mysql ç”¨æˆ·å¯†ç 
      - MYSQL_ROOT_PASSWORD=123456    # è®¾ç½® Mysql root ç”¨æˆ·å¯†ç 
    restart: always
    volumes:
      - ${DATA_PATH_HOST}/mysql:/var/lib/mysql
    networks:
      - demo

  redis:
    image: redis:latest
    ports:
      - "6379:6379"
    container_name: redis-1
    restart: always
    volumes:
      - ${DATA_PATH_HOST}/redis:/data
    networks:
      - demo

  etcd:
    image: bitnami/etcd:latest
    container_name: etcd-1
    environment:
      - TZ=${TZ}
      - ALLOW_NONE_AUTHENTICATION=yes
      #- ETCD_ADVERTISE_CLIENT_URLS=http://etcd:2379
      - ETCD_ADVERTISE_CLIENT_URLS=http://127.0.0.1:2379
    ports: # è®¾ç½®ç«¯å£æ˜ å°„ Etcd æœåŠ¡æ˜ å°„å®¿ä¸»æœºç«¯å£å·ï¼Œå¯åœ¨å®¿ä¸»æœº127.0.0.1:2379è®¿é—®
      - "2379:2379"
      #networks:
      #- backend
    restart: always
    networks:
      - demo
```

æ¥ä¸‹æ¥å°±æ˜¯å¦‚æœæˆ‘ä»¬éœ€è¦ä½¿ç”¨gormå’Œredisçš„è¯ï¼Œå¦‚ä½•åœ¨go-zeroæ¡†æ¶ä¸­ä½¿ç”¨ï¼š

gorm:

```go
package gorm

import (
    "context"
    "github.com/zeromicro/go-zero/core/logx"
    "gorm.io/driver/mysql"
    "gorm.io/gorm"
    "gorm.io/gorm/logger"
    "gozerodemo/server/user/model"
    "log"
    "os"
    "time"
)

const UserDSN = "root:123456@tcp(127.0.0.1:3306)/åŸç¥å¯åŠ¨?charset=utf8mb4&parseTime=True&loc=Local"

var UserDB *gorm.DB

func init() {
    newLogger := logger.New(log.New(os.Stdout, "", log.LstdFlags),
       logger.Config{
          SlowThreshold:             time.Second,
          Colorful:                  true,
          IgnoreRecordNotFoundError: true,
          LogLevel:                  logger.Error,
       })
    db, err := gorm.Open(mysql.Open(UserDSN),
       &gorm.Config{
          Logger: newLogger,
       })
    if err != nil {
       logx.WithContext(context.Background()).Errorf("GORM connect UserDB Error: %+v", err)
    }

    err = db.AutoMigrate(&model.User{})//è¿™é‡Œçš„modeléœ€è¦ä½ æå‰å£°æ˜ï¼ˆä¾‹å¦‚ä½ å¯ä»¥åœ¨apiå’Œrpcç›®å½•ä¸‹æ–°å»ºmodelç›®å½•ï¼Œç„¶ååœ¨modelç›®å½•ä¸­å»å®šä¹‰ï¼‰
    if err != nil {
       logx.WithContext(context.Background()).Errorf("GORM AutoMigrate user ERROR:%+v", err)
    }
    UserDB = db
}
```

redis:

```go
package goredis

import (
    "context"
    "github.com/redis/go-redis/v9"
    "github.com/zeromicro/go-zero/core/logx"
    "time"
)

var Rdb *redis.Client

func init() {
    option := redis.Options{
       Addr:     "localhost:6379",
       DB:       1,
       PoolSize: 100,
    }
    rdb := redis.NewClient(&option)
    _, cancel := context.WithTimeout(context.Background(), 500*time.Millisecond)
    defer cancel()

    _, err := rdb.Ping(context.Background()).Result()
    if err != nil {
       logx.WithContext(context.Background()).Error("Redis connect ERROR: %+v", err)
    }
    Rdb = rdb
}
```

å½“æˆ‘ä»¬è¿™é‡Œåˆå§‹åŒ–æ—¶è¿æ¥äº†mysqlå’Œredisåï¼Œæˆ‘ä»¬ä¹‹åå°±å¯ä»¥ä½¿ç”¨è¿™é‡Œçš„å…¨å±€å¯¹è±¡ï¼ˆ*gorm.DBç±»å‹ï¼‰ï¼ˆ *redis.Clientç±»å‹ï¼‰

åœ¨å“ªä½¿ç”¨ï¼Ÿæ€ä¹ˆç”¨ï¼Ÿ

è¿™æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨goctlç”Ÿæˆåçš„ä»£ç å°±æœ‰ç”¨äº†ã€‚

> example
> â”œâ”€â”€ etc
> â”‚   â””â”€â”€ example.yaml
> â”œâ”€â”€ main.go
> â””â”€â”€ internal
>     â”œâ”€â”€ config
>     â”‚   â””â”€â”€ config.go
>     â”œâ”€â”€ handler
>     â”‚   â”œâ”€â”€ xxxhandler.go
>     â”‚   â””â”€â”€ xxxhandler.go
>     â”œâ”€â”€ logic
>     â”‚   â””â”€â”€ xxxlogic.go
>     â”œâ”€â”€ svc
>     â”‚   â””â”€â”€ servicecontext.go
>     â””â”€â”€ types
>         â””â”€â”€ types.go
>
> - exampleï¼šå•ä¸ªæœåŠ¡ç›®å½•ï¼Œä¸€èˆ¬æ˜¯æŸå¾®æœåŠ¡åç§°
> - etcï¼šé™æ€é…ç½®æ–‡ä»¶ç›®å½•
> - main.goï¼šç¨‹åºå¯åŠ¨å…¥å£æ–‡ä»¶
> - internalï¼šå•ä¸ªæœåŠ¡å†…éƒ¨æ–‡ä»¶ï¼Œå…¶å¯è§èŒƒå›´ä»…é™å½“å‰æœåŠ¡
> - configï¼šé™æ€é…ç½®æ–‡ä»¶å¯¹åº”çš„ç»“æ„ä½“å£°æ˜ç›®å½•
> - handlerï¼šhandler ç›®å½•ï¼Œå¯é€‰ï¼Œä¸€èˆ¬ http æœåŠ¡ä¼šæœ‰è¿™ä¸€å±‚åšè·¯ç”±ç®¡ç†ï¼Œ`handler` ä¸ºå›ºå®šåç¼€
> - logicï¼šä¸šåŠ¡ç›®å½•ï¼Œæ‰€æœ‰ä¸šåŠ¡ç¼–ç æ–‡ä»¶éƒ½å­˜æ”¾åœ¨è¿™ä¸ªç›®å½•ä¸‹é¢ï¼Œ`logic` ä¸ºå›ºå®šåç¼€
> - svcï¼šä¾èµ–æ³¨å…¥ç›®å½•ï¼Œæ‰€æœ‰ logic å±‚éœ€è¦ç”¨åˆ°çš„ä¾èµ–éƒ½è¦åœ¨è¿™é‡Œè¿›è¡Œæ˜¾å¼æ³¨å…¥
> - typesï¼šç»“æ„ä½“å­˜æ”¾ç›®å½•

åœ¨svcä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ ä¸Šgormå’Œredisçš„å…¨å±€å¯¹è±¡ï¼Œæ­£å¦‚å®˜æ–¹æ–‡æ¡£æ‰€è¯´ï¼šæ‰€æœ‰ logic å±‚éœ€è¦ç”¨åˆ°çš„ä¾èµ–éƒ½è¦åœ¨è¿™é‡Œè¿›è¡Œæ˜¾å¼æ³¨å…¥ã€‚



```go
package svc

import (
    "github.com/redis/go-redis/v9"
    "gorm.io/gorm"
    gorm2 "gozerodemo/common/gorm"
    goredis "gozerodemo/common/redis"
    "gozerodemo/server/user/rpc/internal/config"
)

type ServiceContext struct {
    Config  config.Config
    MysqlDB *gorm.DB//è¿™ä¸ªéœ€è¦ä½ åŠ ä¸Šå»
    RedisDB *redis.Client//è¿™ä¸ªéœ€è¦ä½ åŠ ä¸Šå»
}

func NewServiceContext(c config.Config) *ServiceContext {
    return &ServiceContext{
       Config:  c,
       MysqlDB: gorm2.UserDB,//è¿™ä¸ªéœ€è¦ä½ åŠ ä¸Šå»
       RedisDB: goredis.Rdb,//è¿™ä¸ªéœ€è¦ä½ åŠ ä¸Šå»
    }
}
```

åœ¨svcä¸­å¼•å…¥ä¾èµ–åï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨logicä¸­æ­£å¼å†™ä¸šåŠ¡é€»è¾‘äº†ã€‚

```go
package logic

import (
    "context"
    "gozerodemo/server/user/model"
    "gozerodemo/server/user/rpc/internal/svc"
    "gozerodemo/server/user/rpc/pb"

    "github.com/zeromicro/go-zero/core/logx"
)

type RegisterLogic struct {
    ctx    context.Context
    svcCtx *svc.ServiceContext
    logx.Logger
}

func NewRegisterLogic(ctx context.Context, svcCtx *svc.ServiceContext) *RegisterLogic {
    return &RegisterLogic{
       ctx:    ctx,
       svcCtx: svcCtx,
       Logger: logx.WithContext(ctx),
    }
}

func (l *RegisterLogic) Register(in *pb.RegisterReq) (*pb.RegisterResp, error) {
    // todo: add your logic here and delete this line
    l.svcCtx.MysqlDB.Create(model.User{})//ä¸»è¦æ˜¯è¿™é‡Œçœ‹æ€ä¹ˆä½¿ç”¨åˆ°mysqldbçš„ï¼Œæˆ‘ä»¬é€šè¿‡l.svcCtxæ‹¿åˆ°mysqldbã€‚
    return &pb.RegisterResp{}, nil
}
```

é‚£rpcå†™å®Œäº†ï¼Œå¦‚ä½•åœ¨apiå±‚çš„logicä¸­è°ƒç”¨rpcå‘¢ï¼Ÿ

user.yaml

```yaml
Name: user
Host: 0.0.0.0
Port: 8888
#apiä¸­çš„é…ç½®æ–‡ä»¶ä¸­æ–°æ·»user rpc
UserRpcConf:
  Etcd:
    Hosts:
      - 127.0.0.1:2379
    key: user.rpc
```

ç„¶ååœ¨configä¸­å®šä¹‰ä¸€ä¸‹UserRpcConf

```go
package config

import (
    "github.com/zeromicro/go-zero/rest"
    "github.com/zeromicro/go-zero/zrpc"
)

type Config struct {
    rest.RestConf
    UserRpcConf zrpc.RpcClientConf//åŠ å…¥UserRpcConfï¼Œåç»­ä¼šå°†ymlé…ç½®æ–‡ä»¶è§£æåˆ°è¯¥ç»“æ„ä½“ä¸­ã€‚
}
```

ç„¶ååœ¨svcä¸­å£°æ˜ä¾èµ–ï¼š

```go
package svc

import (
    "github.com/zeromicro/go-zero/zrpc"
    "gozerodemo/server/user/api/internal/config"
    "gozerodemo/server/user/rpc/user"
)

type ServiceContext struct {
    Config  config.Config
    UserRPC user.User//userrpcå®¢æˆ·ç«¯
}

func NewServiceContext(c config.Config) *ServiceContext {
    return &ServiceContext{
       Config:  c,
       UserRPC: user.NewUser(zrpc.MustNewClient(c.UserRpcConf)),//åˆ›å»ºuseræœåŠ¡rpcå®¢æˆ·ç«¯
    }
}
```

registerLogic.go

```go
package logic

import (
    "context"

    "gozerodemo/server/user/api/internal/svc"
    "gozerodemo/server/user/api/internal/types"

    "github.com/zeromicro/go-zero/core/logx"
)

type RegisterLogic struct {
    logx.Logger
    ctx    context.Context
    svcCtx *svc.ServiceContext
}

func NewRegisterLogic(ctx context.Context, svcCtx *svc.ServiceContext) *RegisterLogic {
    return &RegisterLogic{
       Logger: logx.WithContext(ctx),
       ctx:    ctx,
       svcCtx: svcCtx,
    }
}

func (l *RegisterLogic) Register(req *types.RegisterReq) (resp *types.RegisterResp, err error) {
    // todo: add your logic here and delete this line
    l.svcCtx.UserRPC.Register()//çœ‹åˆ°äº†å—ï¼Œæˆ‘ä»¬ä¸€æ ·æ˜¯é€šè¿‡l.svcCtxæ¥å¾—åˆ°userRpcæœåŠ¡çš„æ¥å£å¹¶ä½¿ç”¨ã€‚
    return
}
```

è‡³æ­¤ï¼Œä¸€ä¸ªç®€å•çš„go-zeroå¾®æœåŠ¡æµç¨‹å°±èµ°å®Œäº†ã€‚

### åè®°

ä¸Šé¢æ˜¯ä¸€äº›åŸºç¡€çš„go-zeroæ¡†æ¶æ•™ç¨‹ï¼Œä½†å®é™…å¼€å‘ä¸­è¿˜æœ‰å¾ˆå¤šæŠ€æœ¯å¯ä»¥å­¦ä¹ ã€‚

åœ¨è¿™é‡Œæ¨èä¸¤ä¸ªé¡¹ç›®ï¼š

go-zero-looklookï¼ˆ**æŠ€æœ¯æ ˆ**å’Œ**go-zeroå¼€å‘è§„èŒƒ**ï¼‰

> é¡¹ç›®åœ°å€ï¼š[Mikaelemmmm/go-zero-looklook: ğŸ”¥åŸºäºgo-zero(go zero) å¾®æœåŠ¡å…¨æŠ€æœ¯æ ˆå¼€å‘æœ€ä½³å®è·µé¡¹ç›®ã€‚Develop best practice projects based on the full technology stack of go zero (go zero) microservices.](https://github.com/Mikaelemmmm/go-zero-looklook)
>
> é¡¹ç›®æ•™ç¨‹æ–‡æ¡£ï¼š[go-zero-looklook/doc/chinese/01-å¼€å‘ç¯å¢ƒæ­å»º.md at main Â· Mikaelemmmm/go-zero-looklook](https://github.com/Mikaelemmmm/go-zero-looklook/blob/main/doc/chinese/01-å¼€å‘ç¯å¢ƒæ­å»º.md)

lebronï¼ˆåŒæ ·ä½¿ç”¨go-zeroæ¡†æ¶ï¼Œä½†æ›´ä¾§é‡ä¸šåŠ¡ä¸Šçš„è®¾è®¡ï¼Œèƒ½å­¦åˆ°å¾ˆå¤š**ä¸šåŠ¡ä¸Šçš„æŠ€æœ¯**ï¼‰

> é¡¹ç›®åœ°å€ï¼š[zhoushuguang/lebron: Highly concurrent mall system built on go-zero](https://github.com/zhoushuguang/lebron)
>
> é¡¹ç›®æ•™ç¨‹æ–‡æ¡£ï¼š[go-zero å¾®æœåŠ¡å®æˆ˜ç³»åˆ—ï¼ˆä¸€ã€å¼€ç¯‡ï¼‰](https://mp.weixin.qq.com/s?__biz=Mzg2ODU1MTI0OA==&mid=2247485597&idx=1&sn=7e85894b7847cc50df51d66092792453&chksm=ceabd7a2f9dc5eb40ace3dc87dda90479403f2ed778c3bf1375e98841712f05392cc92ccb058&cur_album_id=2085775054620917763&scene=190#rd)

go-zero-looklookä½œè€…çš„go-zeroæ¡†æ¶è§†é¢‘æ•™ç¨‹ï¼š[ä¸€ã€go-zeroç®€ä»‹åŠå¦‚ä½•å­¦go-zero_å“”å“©å“”å“©_bilibili](https://www.bilibili.com/video/BV1LS4y1U72n/?spm_id_from=333.1387.upload.video_card.click&vd_source=efb2c7d5cee1018e00a007912051cabb)

ä½œä¸šï¼š

lv1:ç”¨go-zeroå†™ä¸ªdemoè·‘èµ·æ¥ç”¨postmanä¹‹ç±»çš„è¯·æ±‚çœ‹çœ‹ã€‚

lv2:å¯ä»¥å­¦ä¹ ä¸€ä¸‹æ¨èçš„é¡¹ç›®ã€‚

æ— éœ€æäº¤
